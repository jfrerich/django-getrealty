{% extends "jobs/base.html" %}
{% load i18n %}

{% block content %}

  <div class="container-fluid">
    <div style="margin-top: 10px" class="row">
      <nav class="sidebar col-lg-2 d-none d-lg-block">

        <div class="sidebar-sticky">

          <ul class="nav nav-pills flex-column">
            <li class="nav-item">
              <a class="nav-link" data-toggle="pill" href="{% url 'overview' %}" data-target="#overviewPage">
              <i class="fa fa-home"></i>Overview</a>
            </li>
            <li class="nav-item">
              <hr/>
              <a class="nav-link" data-toggle="pill" href="{% url 'query' %}" data-target="#getRealtyOptionsPage">
              <i class="fa fa-search"></i> Query Properties </a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" data-toggle="pill" href="{% url 'viewDb' %}" data-target="#viewDbPage">
              <i class="fa fa-file-text-o"></i> View Properties</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="pill" href="{% url 'viewModelDb_data' %}" data-target="#viewDbModelPage">
              <i class="fa fa-file-text-o"></i> View Model Properties</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="pill" href="{% url 'detail' %}" data-target="#propertyDetailPage">
              <i class="fa fa-file-text-o"></i> Property Detail </a>
            </li>
            <li class="nav-item">
              <hr/>
              <a class="nav-link" data-toggle="pill" href="{% url 'testpage' %}" data-target="#testPage">
              <i class="fa fa-life-ring"></i> test_page.html</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" data-toggle="pill" href="{% url 'testPage2' %}" data-target="#test_Page2">
              <i class="fa fa-life-ring"></i> testPage2.html</a>
            </li>
          </ul>

        </div>

      </nav>

      <main role="main" class="ml-lg-auto col-lg-10">
        <div class="tab-content col-lg-12 visibility">
            <div role="tabpanel" class="tab-pane" id="overviewPage"></div>
            <div role="tabpanel" class="tab-pane" id="getRealtyOptionsPage"></div> 
            <div role="tabpanel" class="tab-pane" id="viewDbPage"></div>
            <div role="tabpanel" class="tab-pane" id="viewDbModelPage"></div>
            <div role="tabpanel" class="tab-pane" id="propertyDetailPage"></div>
            <div role="tabpanel" class="tab-pane" id="testPage"></div> 
            <div role="tabpanel" class="tab-pane" id="test_Page2"></div> 
        </div>
        </main>

      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <script>

      // $(function() {
      //   $("#employeeLink").on("click",function(e) {
      //     e.preventDefault(); // cancel the link itself
      //     $.post(this.href,function(data) {
      //         $("#someContainer").html(data);
      //     });
      //   });
      // });

      // handle clicking of pills
      // change pill highlight and load html for selected pill
      // https://stackoverflow.com/questions/36982744/bootstrap-tab-ajax-load-content-when-page-loaded
      var csrftoken = Cookies.get('csrftoken');
      console.log('csrftoken' + csrftoken)

      // // var csrf_token = $('meta[name="csrf-token"]').attr('content');
      // function csrfSafeMethod(method) {
      //     // these HTTP methods do not require CSRF protection
      //     return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
      // }

      $('[data-toggle="pill"]').click(function(e) {
          // e.preventDefault(); // cancel the link itself
          // alert('clicked', e.target.href)
          // e.preventDefault()
          var $this = $(this),
              loadurl = $this.attr('href'),
              targ = $this.attr('data-target');

          console.log('loadurl: ' + loadurl)
          console.log('this: ' + this)
          console.log('targ: ' + targ)

          // $.ajaxSetup({
          //     beforeSend: function(xhr, settings) {
          //         if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
          //             xhr.setRequestHeader("X-CSRFToken", csrftoken);
          //         }
          //     }
          // });

          // $.ajaxPrefilter(function(options, originalOptions, jqXHR){
          //     if (options.type.toLowerCase() === "post") {
          //         // initialize `data` to empty string if it does not exist
          //         options.data = options.data || "";
          //
          //         // add leading ampersand if `data` is non-empty
          //         options.data += options.data?"&":"";
          //
          //         // add _token entry
          //         options.data += "_token=" + encodeURIComponent(csrftoken);
          //     }
          // });

          // $.post(loadurl, function(data) {
          $.get(loadurl, function(data) {
             $(targ).html(data);
          });
          
          $this.tab('show');
          return false;
      });

    </script>

{% endblock %}
